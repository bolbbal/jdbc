package javaJDBCentry;

import java.sql.*;
import java.util.*;

public class EntryDao {
	Scanner sc = new Scanner(System.in);
	
	public void insertEntry() {
		System.out.println(">>경영점수 등록 화면");
		System.out.print("참가 번호 : ");
		String entryNo = sc.next();
		System.out.println("심사위원 점수 등록");
		System.out.print("김심사 점수 : ");
		int score1 = sc.nextInt();
		System.out.print("이심사 점수 : ");
		int score2 = sc.nextInt();
		System.out.print("박심사 점수 : ");
		int score3 = sc.nextInt();
		System.out.print("황심사 점수 : ");
		int score4 = sc.nextInt();
		System.out.print("조심사 점수 : ");
		int score5 = sc.nextInt();
		System.out.print("등록여부 [Y/N]");
		String decide = sc.next();
		if(decide.equalsIgnoreCase("n")) {
			return;
		} else if(decide.equalsIgnoreCase("y")) {
			Connection conn = null;
			PreparedStatement pstmt = null;
			
			String sql = "insert into entry_no values (?,?,?,?,?,?)";
			
			try {
				conn = DBManager.getInstance().getDBManger();
				pstmt = conn.prepareStatement(sql);
				pstmt.setString(1, entryNo);
				pstmt.setInt(2, score1);
				pstmt.setInt(3, score2);
				pstmt.setInt(4, score3);
				pstmt.setInt(5, score4);
				pstmt.setInt(6, score5);
				pstmt.executeUpdate();
			} catch (Exception e) {
				e.printStackTrace();
			}
		} 
	}
	public void selectEntry() {
		Connection conn = null;
		PreparedStatement pstmt = null;
		ResultSet rs = null;
		System.out.print("참가번호를 입력하세요 : ");
		String entryNo = sc.next();
		
		String sql = "select et.entry_no, et.entry_name, et.entry_jumin, et.entry_type, et.entry_area, rc.score1, rc.score2, rc.score3, rc.score4, rc.score5, rc.s_tot, rc.s_ave\r\n" + 
				"from tbl_entry_202106 et, tbl_record_202106 rc, tbl_referee_202106 re\r\n" + 
				"where et.entry_no = rc.entry_no";
		
		try {
			conn = DBManager.getInstance().getDBManger();
			pstmt = conn.prepareStatement(sql);
			rs = pstmt.executeQuery();
			List<EntryVo> list = new ArrayList<EntryVo>();
			while (rs.next()) {
				EntryVo vo = new EntryVo();
				vo.setEntry_no(rs.getString("entry_no"));
				if(vo.getEntry_no().equals(entryNo)) {
					vo.setEntry_name(rs.getString("entry_name"));
					vo.setEntry_jumin(rs.getString("entry_jumin"));
					vo.setEntry_type(rs.getString("entry_type"));
					vo.setEntry_area(rs.getString("entry_area"));
					vo.setScore1(rs.getInt("score1"));
					vo.setScore2(rs.getInt("score2"));
					vo.setScore3(rs.getInt("score3"));
					vo.setScore4(rs.getInt("score4"));
					vo.setScore5(rs.getInt("score5"));
					vo.setS_tot(rs.getInt("s_tot"));
					vo.setS_ave(rs.getDouble("s_ave"));
				} 
			}
		} catch (Exception e) {
			e.printStackTrace();
		}
		
	}
}
